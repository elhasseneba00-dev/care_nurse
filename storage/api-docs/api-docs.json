{
    "openapi": "3.0.0",
    "info": {
        "title": "CareNear API",
        "description": "CareNear backend API (Laravel). Dev docs only.",
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "/api/v1",
            "description": "Local (Herd) base path"
        }
    ],
    "paths": {
        "/login": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Login with phone and password",
                "description": "Returns a Sanctum token (Bearer).",
                "operationId": "42f77e072dec84b0e1094cca1228298e",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "phone",
                                    "password"
                                ],
                                "properties": {
                                    "phone": {
                                        "type": "string",
                                        "example": "22222222222"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "password123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "token_type": {
                                            "type": "string",
                                            "example": "Bearer"
                                        },
                                        "access_token": {
                                            "type": "string",
                                            "example": "1|xxxxxxxxxxxxxxxx"
                                        },
                                        "data": {
                                            "properties": {
                                                "user": {
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Invalid credentials / validation error"
                    },
                    "403": {
                        "description": "Account not active"
                    }
                }
            }
        },
        "/logout": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Logout (revoke current token)",
                "operationId": "03afb12b342c2ea43bdc1de4f39e91a8",
                "responses": {
                    "204": {
                        "description": "Logged out"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/me": {
            "get": {
                "tags": [
                    "Auth"
                ],
                "summary": "Get current authenticated user",
                "operationId": "981e98a62b4d3d710add6e9e0d6478bb",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/register": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Register a new user",
                "description": "Returns a Sanctum token (Bearer).",
                "operationId": "573de1fed352c1205a32c4d1b9877375",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "full_name",
                                    "phone",
                                    "password",
                                    "role"
                                ],
                                "properties": {
                                    "full_name": {
                                        "type": "string",
                                        "example": "John Doe"
                                    },
                                    "phone": {
                                        "type": "string",
                                        "example": "22222222222"
                                    },
                                    "email": {
                                        "type": "string",
                                        "example": ""
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "password123"
                                    },
                                    "role": {
                                        "type": "string",
                                        "enum": [
                                            "USER",
                                            "ADMIN"
                                        ],
                                        "example": "USER"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "token_type": {
                                            "type": "string",
                                            "example": "Bearer"
                                        },
                                        "access_token": {
                                            "type": "string",
                                            "example": "1|xxxxxxxxxxxxxxxx"
                                        },
                                        "data": {
                                            "properties": {
                                                "user": {
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/care-requests": {
            "get": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "List care requests for current user",
                "description": "PATIENT: returns own requests. NURSE: returns assigned + nearby open BROADCAST + open TARGETED (to self). ADMIN: all.",
                "operationId": "c6d443ac069e45d806159d7208a5381e",
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "401": {
                        "description": "Unauthenticated"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "Create a new care request",
                "description": "PATIENT only. Supports BROADCAST (default) or TARGETED (to a specific verified nurse).",
                "operationId": "82a95992d779e9546e7ee0d10b37f7f0",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "care_type",
                                    "address",
                                    "city",
                                    "lat",
                                    "lng"
                                ],
                                "properties": {
                                    "care_type": {
                                        "type": "string",
                                        "example": "Injection"
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Besoin d'une injection IM",
                                        "nullable": true
                                    },
                                    "scheduled_at": {
                                        "type": "string",
                                        "format": "date-time",
                                        "example": "2026-01-02T10:00:00Z",
                                        "nullable": true
                                    },
                                    "address": {
                                        "type": "string",
                                        "example": "Tevragh Zeina"
                                    },
                                    "city": {
                                        "type": "string",
                                        "example": "Nouakchott"
                                    },
                                    "lat": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 18.102
                                    },
                                    "lng": {
                                        "type": "number",
                                        "format": "float",
                                        "example": -15.958
                                    },
                                    "visibility": {
                                        "type": "string",
                                        "enum": [
                                            "BROADCAST",
                                            "TARGETED"
                                        ],
                                        "example": "BROADCAST"
                                    },
                                    "target_nurse_user_id": {
                                        "type": "integer",
                                        "example": 123,
                                        "nullable": true
                                    },
                                    "expires_at": {
                                        "type": "string",
                                        "format": "date-time",
                                        "example": "2026-01-02T10:10:00Z",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/care-requests/{careRequest}": {
            "get": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "Get a care request",
                "operationId": "b5957907961a41cc7ef45ec818425f71",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/care-requests/{careRequest}/accept": {
            "post": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "Accept an open care request",
                "description": "NURSE only. For TARGETED, only the targeted nurse can accept.",
                "operationId": "ef39e3a269695a836a8db2634d749cce",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "409": {
                        "description": "No longer available"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/care-requests/{careRequest}/ignore": {
            "post": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "Ignore an open care request",
                "description": "NURSE only. Only for open BROADCAST requests.",
                "operationId": "6c4aa62075105a0f385c12815d117284",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "No content"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "422": {
                        "description": "Invalid request state"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/care-requests/{careRequest}/cancel": {
            "post": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "Cancel a care request",
                "description": "PATIENT only. Allowed statuses: PENDING or ACCEPTED.",
                "operationId": "40f9d52d2fdf8028886d5a07d01da691",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "422": {
                        "description": "Invalid status"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/care-requests/{careRequest}/complete": {
            "post": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "Complete a care request",
                "description": "NURSE only. Allowed status: ACCEPTED. Marks it as DONE.",
                "operationId": "5ab2a1cd08586f4cb863884d7f6e16b3",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "422": {
                        "description": "Invalid status"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/care-requests/{careRequest}/rebook": {
            "post": {
                "tags": [
                    "Care Requests"
                ],
                "summary": "Rebook based on a previous care request",
                "description": "PATIENT only. Only allowed when original request is DONE. Can rebook as TARGETED (same nurse) or BROADCAST.",
                "operationId": "1f4a4565ee817e0ee5bd54400930ef50",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "same_nurse": {
                                        "type": "boolean",
                                        "example": true
                                    },
                                    "scheduled_at": {
                                        "type": "string",
                                        "format": "date-time",
                                        "example": "2026-01-02T10:00:00Z",
                                        "nullable": true
                                    },
                                    "expires_at": {
                                        "type": "string",
                                        "format": "date-time",
                                        "example": "2026-01-02T10:10:00Z",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "422": {
                        "description": "Invalid status"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/care-requests/{careRequest}/messages": {
            "get": {
                "tags": [
                    "Chat"
                ],
                "summary": "List last messages for a care request",
                "operationId": "c5717535c866701ee0b294369c1bdbd2",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Chat"
                ],
                "summary": "Send a message in care request chat",
                "description": "Chat is available only after ACCEPTED (or DONE). Contact sharing is masked and triggers a warning.",
                "operationId": "f00bdb341c45f7d12e75285b012584b8",
                "parameters": [
                    {
                        "name": "careRequest",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "message"
                                ],
                                "properties": {
                                    "message": {
                                        "type": "string",
                                        "example": "Bonjour, je suis en route."
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "422": {
                        "description": "Validation error / Chat not available"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/favorites": {
            "get": {
                "tags": [
                    "Favorites"
                ],
                "summary": "List favorite nurses",
                "operationId": "2864588f4b33309f00e731dd0439c4ba",
                "responses": {
                    "200": {
                        "description": "OK"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/favorites/{nurseUserId}": {
            "post": {
                "tags": [
                    "Favorites"
                ],
                "summary": "Add a nurse to favorites",
                "operationId": "78d416586f6d2bdcae207c8b155bb565",
                "parameters": [
                    {
                        "name": "nurseUserId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "No content"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "422": {
                        "description": "Invalid nurse"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Favorites"
                ],
                "summary": "Remove a nurse from favorites",
                "operationId": "57025e94acfa0575e0293f24dd9c05fe",
                "parameters": [
                    {
                        "name": "nurseUserId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "No content"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/notifications": {
            "get": {
                "tags": [
                    "Notifications"
                ],
                "summary": "List notifications",
                "operationId": "bccfaed8d90619a05dd719915832d8f3",
                "parameters": [
                    {
                        "name": "unread",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "boolean"
                        }
                    },
                    {
                        "name": "per_page",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 20
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/notifications/{id}/read": {
            "post": {
                "tags": [
                    "Notifications"
                ],
                "summary": "Mark one notification as read",
                "operationId": "4d19578949c3095ed0a95ad6ffac1827",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "No content"
                    },
                    "404": {
                        "description": "Not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/notifications/read-all": {
            "post": {
                "tags": [
                    "Notifications"
                ],
                "summary": "Mark all notifications as read",
                "operationId": "b57edd56765d08d9d25ee1696b19d436",
                "responses": {
                    "204": {
                        "description": "No content"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        }
    },
    "components": {
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "description": "Use Sanctum token as Bearer token",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Auth",
            "description": "Auth"
        },
        {
            "name": "Care Requests",
            "description": "Care Requests"
        },
        {
            "name": "Chat",
            "description": "Chat"
        },
        {
            "name": "Favorites",
            "description": "Favorites"
        },
        {
            "name": "Notifications",
            "description": "Notifications"
        }
    ]
}